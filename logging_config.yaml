version: 1
disable_existing_loggers: False # ë‹¤ë¥¸ ë¼ì´ë¸ŒëŸ¬ë¦¬ì˜ ë¡œê±° ì„¤ì •ì„ ìœ ì§€

formatters:
  default:
    # ê¸°ë³¸ í¬ë§¤í„°: ì½˜ì†” ì¶œë ¥ìš©. trace_id, node_name, retry_count í¬í•¨ (ê¸°ë³¸ê°’ ì œê³µ)
    format: "[%(asctime)s] [%(levelname)s] [%(name)s] [%(trace_id)s] [%(node_name)s] [Retry:%(retry_count)s] - %(message)s"
    datefmt: "%Y-%m-%d %H:%M:%S"
    # LogRecordì— í•´ë‹¹ ì†ì„±ì´ ì—†ì„ ê²½ìš° ì‚¬ìš©ë  ê¸°ë³¸ê°’
    defaults:
      trace_id: "N/A"
      node_name: "N/A"
      retry_count: 0
  detailed:
    # ìƒì„¸ í¬ë§¤í„°: íŒŒì¼ ë¡œê¹…ìš©. ì¶”ê°€ ì •ë³´(lineno, threadName) í¬í•¨
    format: "[%(asctime)s] [%(levelname)s] [%(name)s:%(lineno)d] [%(threadName)s] [%(trace_id)s] [%(node_name)s] [Retry:%(retry_count)s] - %(message)s"
    datefmt: '%Y-%m-%d %H:%M:%S'
    defaults:
      trace_id: "N/A"
      node_name: "N/A"
      retry_count: 0

handlers:
  console:
    class: logging.StreamHandler
    level: INFO  # ì½˜ì†”ì—ëŠ” INFO ë ˆë²¨ ì´ìƒë§Œ ì¶œë ¥
    formatter: default # ê¸°ë³¸ í¬ë§¤í„° ì‚¬ìš©
    stream: ext://sys.stdout # í‘œì¤€ ì¶œë ¥ìœ¼ë¡œ ìŠ¤íŠ¸ë¦¼

  file_handler: # ğŸš¨ íŒŒì¼ í•¸ë“¤ëŸ¬ ì„¤ì •
    class: logging.handlers.RotatingFileHandler # ë¡œê·¸ íŒŒì¼ ìˆœí™˜
    level: DEBUG  # íŒŒì¼ì—ëŠ” DEBUG ë ˆë²¨ ì´ìƒ ëª¨ë‘ ê¸°ë¡
    formatter: detailed # ìƒì„¸ í¬ë§¤í„° ì‚¬ìš©
    # â¬‡ï¸ í”„ë¡œì íŠ¸ ë£¨íŠ¸(ai/) ê¸°ì¤€ì˜ ìƒëŒ€ ê²½ë¡œë¡œ ëª…ì‹œì  ë³€ê²½ â¬‡ï¸
    # ì˜ˆ: ai/logs/app_workflow.log ì— ì €ì¥ë˜ë„ë¡
    filename: logs/app_workflow.log
    maxBytes: 10485760 # ë¡œê·¸ íŒŒì¼ ìµœëŒ€ í¬ê¸° (ì˜ˆ: 10MB)
    backupCount: 5     # ìœ ì§€í•  ë°±ì—… íŒŒì¼ ê°œìˆ˜ (ì˜ˆ: 5ê°œ)
    encoding: utf8     # íŒŒì¼ ì¸ì½”ë”©

loggers:
  # íŠ¹ì • ë¼ì´ë¸ŒëŸ¬ë¦¬ì˜ ë¡œê·¸ ë ˆë²¨ ì¡°ì • (ë„ˆë¬´ ìƒì„¸í•œ ë¡œê·¸ ë°©ì§€)
  httpx:
    level: WARNING
    handlers: [console, file_handler]
    propagate: no
  aiohttp:
    level: WARNING
    handlers: [console, file_handler]
    propagate: no
  # ë‹¤ë¥¸ ì£¼ìš” ë¼ì´ë¸ŒëŸ¬ë¦¬ ë¡œê±° ì¶”ê°€ ê°€ëŠ¥
  # ì˜ˆë¥¼ ë“¤ì–´, transformers ë¼ì´ë¸ŒëŸ¬ë¦¬ì˜ ìƒì„¸ ë¡œê·¸ë¥¼ ì¤„ì´ê³  ì‹¶ë‹¤ë©´:
  # transformers:
  #   level: WARNING
  #   handlers: [console, file_handler]
  #   propagate: no
  # vllm: # vLLM ê´€ë ¨ ë¡œê·¸ ì¡°ì •
  #   level: INFO # ë˜ëŠ” WARNING
  #   handlers: [console, file_handler]
  #   propagate: no
  # FastAPI (uvicorn) ë¡œê·¸ ì¡°ì •
  uvicorn.error:
    level: WARNING # Uvicorn ì˜¤ë¥˜ëŠ” WARNING ì´ìƒë§Œ
    handlers: [console, file_handler]
    propagate: no
  uvicorn.access:
    level: INFO # ì ‘ê·¼ ë¡œê·¸ëŠ” INFO ë ˆë²¨ (í”„ë¡œë•ì…˜ì—ì„œëŠ” WARNING/ERRORë¡œ ë³€ê²½ ê³ ë ¤)
    handlers: [console, file_handler]
    propagate: no


root: # ë£¨íŠ¸ ë¡œê±°: ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ ëª¨ë“  ë¡œê±°ê°€ ìƒì†í•˜ëŠ” ê¸°ë³¸ ì„¤ì •
  level: DEBUG # ê¸°ë³¸ ë¡œê·¸ ë ˆë²¨ì€ DEBUG (íŒŒì¼ í•¸ë“¤ëŸ¬ê°€ ì²˜ë¦¬í•  ìˆ˜ ìˆë„ë¡)
  handlers: [console, file_handler] # ì½˜ì†”ê³¼ íŒŒì¼ í•¸ë“¤ëŸ¬ ëª¨ë‘ ì ìš©